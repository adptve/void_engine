# =============================================================================
# Dungeon Crawler - Scene Definition
# =============================================================================
# Visual scene for the dungeon crawler example
# Game logic defined in: items/, weapons/, ai/, ui/, scripts/

[scene]
name = "Dungeon Crawler - Level 1"
description = "Dark dungeon with enemies, pickups, and boss encounter"
version = "1.0.0"

# =============================================================================
# Game Items
# =============================================================================

[[items]]
id = "health_potion"
name = "Health Potion"
description = "Restores 50 HP"
item_type = "consumable"
max_stack = 10
value = 25

[items.consumable]
use_time = 1.0
animation = "drink"

[[items.consumable.effects]]
type = "restore_health"
amount = 50

[[items]]
id = "gold_coin"
name = "Gold Coin"
description = "Currency"
item_type = "misc"
max_stack = 999
value = 1

[[items]]
id = "rusty_key"
name = "Rusty Key"
description = "Opens old dungeon doors"
item_type = "key"
max_stack = 1
value = 0

# =============================================================================
# Status Effects
# =============================================================================

[[status_effects]]
name = "burning"
duration = 5.0
tick_rate = 1.0
stacks = true
max_stacks = 3

[[status_effects.effects]]
type = "damage_over_time"
damage = 5.0
damage_type = "fire"

[[status_effects]]
name = "poisoned"
duration = 10.0
tick_rate = 2.0
stacks = false

[[status_effects.effects]]
type = "damage_over_time"
damage = 3.0
damage_type = "poison"

[[status_effects.effects]]
type = "speed_modifier"
multiplier = 0.8

# =============================================================================
# Quests
# =============================================================================

[[quests]]
id = "clear_dungeon"
name = "Clear the Dungeon"
description = "Defeat all skeleton warriors"
auto_start = true

[[quests.objectives]]
id = "kill_skeletons"
description = "Defeat skeleton warriors"
type = "kill"
target = "skeleton"
count = 2

[[quests.rewards]]
type = "item"
item = "gold_coin"
count = 100

# =============================================================================
# Camera System - First Person
# =============================================================================

[[cameras]]
name = "player_camera"
active = true
type = "perspective"
control_mode = "fps"  # First-person shooter style camera

[cameras.transform]
position = [0.0, 2.9, 10.0]  # Player eye height at spawn point (capsule center 2.2 + eye offset 0.7)
target = [0.0, 2.9, 0.0]     # Looking into the dungeon
up = [0.0, 1.0, 0.0]

[cameras.perspective]
fov = 60.0   # Standard FOV
near = 0.1
far = 200.0
aspect = "auto"

# =============================================================================
# Lighting System - Dark dungeon atmosphere
# =============================================================================

# Dim ambient/directional light
[[lights]]
name = "ambient_light"
type = "directional"
enabled = true

[lights.directional]
direction = [0.2, -0.8, 0.3]
color = [0.3, 0.3, 0.4]
intensity = 0.3
cast_shadows = true

# Torch light 1 - entrance
[[lights]]
name = "torch_1"
type = "point"
enabled = true

[lights.point]
position = [-5.0, 2.5, -8.0]
color = [1.0, 0.6, 0.2]
intensity = 40.0
range = 8.0
cast_shadows = false

[lights.point.attenuation]
constant = 1.0
linear = 0.14
quadratic = 0.07

# Torch light 2 - corridor
[[lights]]
name = "torch_2"
type = "point"
enabled = true

[lights.point]
position = [5.0, 2.5, -8.0]
color = [1.0, 0.6, 0.2]
intensity = 40.0
range = 8.0
cast_shadows = false

# Torch light 3 - mid chamber
[[lights]]
name = "torch_3"
type = "point"
enabled = true

[lights.point]
position = [0.0, 2.5, 0.0]
color = [1.0, 0.5, 0.15]
intensity = 60.0
range = 12.0
cast_shadows = true

# Boss room red glow
[[lights]]
name = "boss_glow"
type = "point"
enabled = true

[lights.point]
position = [0.0, 3.0, -20.0]
color = [1.0, 0.2, 0.1]
intensity = 80.0
range = 15.0
cast_shadows = true

# =============================================================================
# Shadow Configuration
# =============================================================================

[shadows]
enabled = true
atlas_size = 2048
max_shadow_distance = 40.0

[shadows.cascades]
count = 2
split_scheme = "practical"
lambda = 0.5

[[shadows.cascades.levels]]
resolution = 1024
distance = 15.0
bias = 0.001

[[shadows.cascades.levels]]
resolution = 512
distance = 40.0
bias = 0.002

[shadows.filtering]
method = "pcf"
pcf_samples = 8
soft_shadows = true

# =============================================================================
# Environment Settings - Dark dungeon
# =============================================================================

[environment]
ambient_intensity = 0.15  # Increased for better visibility

[environment.sky]
zenith_color = [0.02, 0.02, 0.05]
horizon_color = [0.05, 0.05, 0.08]
ground_color = [0.02, 0.02, 0.02]
fog_density = 0.005  # Reduced fog for better visibility

# =============================================================================
# Picking Configuration
# =============================================================================

[picking]
enabled = true
method = "gpu"
max_distance = 50.0
layer_mask = ["world", "pickups", "enemies"]

[picking.gpu]
buffer_size = [256, 256]
readback_delay = 1

# =============================================================================
# Input Configuration
# =============================================================================

[input.camera]
# FPS mode uses mouse for looking (always active, no button needed)
# These settings still apply for mouse sensitivity
orbit_sensitivity = 0.003  # Used as mouse look sensitivity in FPS mode
zoom_scroll = false        # Disabled for FPS - no zoom
min_distance = 0.5
max_distance = 100.0

[input.bindings]
# Movement (WASD)
move_forward = "W"
move_back = "S"
move_left = "A"
move_right = "D"
# Combat
attack = "Mouse1"
block = "Mouse2"
use_item = "E"
# Quick slots
quickslot_1 = "1"
quickslot_2 = "2"
quickslot_3 = "3"
quickslot_4 = "4"
quickslot_5 = "5"
# UI
toggle_inventory = "I"
pause = "Escape"
toggle_debug = "F3"

# =============================================================================
# Entities - Dungeon Environment
# =============================================================================

# Floor tiles
[[entities]]
name = "dungeon_floor"
mesh = "plane"
layer = "world"
visible = true

[entities.transform]
position = [0.0, 0.0, 0.0]
scale = 20.0

[entities.material]
albedo = [0.15, 0.12, 0.1]
metallic = 0.0
roughness = 0.9

[entities.physics]
body_type = "static"

[entities.physics.shape]
type = "box"
# Thick floor collider - half_extents get multiplied by scale (20)
# Final size: 20x1x20 (top surface at Y=1.0)
half_extents = [1.0, 0.05, 1.0]

# Stone walls (simplified as cubes for visualization)
# Note: Physics half_extents are in LOCAL space before scale is applied
[[entities]]
name = "wall_north"
mesh = "cube"
layer = "world"
visible = true

[entities.transform]
position = [0.0, 2.0, -25.0]
scale = [25.0, 4.0, 1.0]

[entities.material]
albedo = [0.2, 0.18, 0.16]
metallic = 0.0
roughness = 0.95

[entities.physics]
body_type = "static"

[entities.physics.shape]
type = "box"
half_extents = [0.5, 0.5, 0.5]

[[entities]]
name = "wall_south"
mesh = "cube"
layer = "world"
visible = true

[entities.transform]
position = [0.0, 2.0, 15.0]
scale = [25.0, 4.0, 1.0]

[entities.material]
albedo = [0.2, 0.18, 0.16]
metallic = 0.0
roughness = 0.95

[entities.physics]
body_type = "static"

[entities.physics.shape]
type = "box"
half_extents = [0.5, 0.5, 0.5]

[[entities]]
name = "wall_east"
mesh = "cube"
layer = "world"
visible = true

[entities.transform]
position = [12.0, 2.0, -5.0]
scale = [1.0, 4.0, 20.0]

[entities.material]
albedo = [0.2, 0.18, 0.16]
metallic = 0.0
roughness = 0.95

[entities.physics]
body_type = "static"

[entities.physics.shape]
type = "box"
half_extents = [0.5, 0.5, 0.5]

[[entities]]
name = "wall_west"
mesh = "cube"
layer = "world"
visible = true

[entities.transform]
position = [-12.0, 2.0, -5.0]
scale = [1.0, 4.0, 20.0]

[entities.material]
albedo = [0.2, 0.18, 0.16]
metallic = 0.0
roughness = 0.95

[entities.physics]
body_type = "static"

[entities.physics.shape]
type = "box"
half_extents = [0.5, 0.5, 0.5]

# =============================================================================
# Player Character
# =============================================================================

[[entities]]
name = "player"
mesh = "sphere"
layer = "world"
visible = false  # Invisible in first-person

[entities.transform]
position = [0.0, 2.2, 10.0]  # Y=2.2 puts capsule bottom at Y=1.1 (just above floor top at Y=1.0)
scale = 0.8

[entities.material]
albedo = [0.2, 0.5, 0.8]
metallic = 0.3
roughness = 0.4
emissive = [0.05, 0.1, 0.2]

[entities.pickable]
enabled = true
priority = 10

# Player physics - capsule collider for character controller
[entities.physics]
body_type = "player"
friction = 0.0

[entities.physics.shape]
type = "capsule"
half_height = 0.7
radius = 0.4

# Player health
[entities.health]
max_health = 100.0
regeneration = 2.0
regen_delay = 5.0

# Player weapon
[entities.weapon]
name = "Sword"
weapon_type = "melee"
damage = 25.0
damage_type = "physical"
fire_rate = 1.5

[entities.weapon.melee]
range = 2.5
angle = 90.0

# Player inventory
[entities.inventory]
slots = 20
max_weight = 50.0

# =============================================================================
# Enemies - Skeleton Warriors
# =============================================================================

[[entities]]
name = "skeleton_1"
mesh = "cube"
layer = "enemies"
visible = true

[entities.transform]
position = [-3.0, 1.0, -5.0]
scale = [0.6, 1.5, 0.4]

[entities.material]
albedo = [0.9, 0.9, 0.85]
metallic = 0.0
roughness = 0.8

[entities.animation]
type = "oscillate"
axis = [0.0, 1.0, 0.0]
amplitude = 0.1
frequency = 0.5

[entities.pickable]
enabled = true
highlight_on_hover = true

# Skeleton health
[entities.health]
max_health = 50.0

# Skeleton weapon
[entities.weapon]
name = "Bone Sword"
weapon_type = "melee"
damage = 15.0
damage_type = "physical"
fire_rate = 1.0

[entities.weapon.melee]
range = 1.5
angle = 60.0

# Skeleton AI
[entities.ai]
type = "state_machine"
initial_state = "patrol"
faction = "enemy"
aggro_range = 15.0
states = [
    { name = "patrol" },
    { name = "chase" },
    { name = "attack" }
]

[[entities]]
name = "skeleton_2"
mesh = "cube"
layer = "enemies"
visible = true

[entities.transform]
position = [4.0, 1.0, -8.0]
scale = [0.6, 1.5, 0.4]

[entities.material]
albedo = [0.9, 0.9, 0.85]
metallic = 0.0
roughness = 0.8

[entities.animation]
type = "oscillate"
axis = [0.0, 1.0, 0.0]
amplitude = 0.1
frequency = 0.6

[entities.pickable]
enabled = true
highlight_on_hover = true

# Skeleton Archer
[[entities]]
name = "skeleton_archer"
mesh = "cube"
layer = "enemies"
visible = true

[entities.transform]
position = [8.0, 1.0, -12.0]
scale = [0.5, 1.4, 0.4]

[entities.material]
albedo = [0.85, 0.85, 0.8]
metallic = 0.0
roughness = 0.75

[entities.pickable]
enabled = true
highlight_on_hover = true

# =============================================================================
# Boss - Demon Lord
# =============================================================================

[[entities]]
name = "boss_demon"
mesh = "sphere"
layer = "enemies"
visible = true

[entities.transform]
position = [0.0, 2.5, -20.0]
scale = 2.0

[entities.material]
albedo = [0.4, 0.1, 0.1]
metallic = 0.2
roughness = 0.6
emissive = [0.3, 0.05, 0.0]

[entities.animation]
type = "pulse"
min_scale = 0.95
max_scale = 1.05
frequency = 0.3

[entities.pickable]
enabled = true
priority = 100
highlight_on_hover = true

# =============================================================================
# Pickups - Health Potion
# =============================================================================

[[entities]]
name = "health_potion_1"
mesh = "sphere"
layer = "pickups"
visible = true

[entities.transform]
position = [-6.0, 0.5, 2.0]
scale = 0.3

[entities.material]
albedo = [0.9, 0.1, 0.1]
metallic = 0.0
roughness = 0.2
emissive = [0.2, 0.0, 0.0]

[entities.animation]
type = "oscillate"
axis = [0.0, 1.0, 0.0]
amplitude = 0.15
frequency = 1.0

[entities.pickable]
enabled = true
highlight_on_hover = true

[entities.trigger]
mode = "once"
event = "pickup_health"

[entities.trigger.shape]
type = "sphere"
radius = 1.0

# Mana Potion
[[entities]]
name = "mana_potion_1"
mesh = "sphere"
layer = "pickups"
visible = true

[entities.transform]
position = [5.0, 0.5, -3.0]
scale = 0.3

[entities.material]
albedo = [0.1, 0.2, 0.9]
metallic = 0.0
roughness = 0.2
emissive = [0.0, 0.05, 0.25]

[entities.animation]
type = "oscillate"
axis = [0.0, 1.0, 0.0]
amplitude = 0.15
frequency = 1.2

[entities.pickable]
enabled = true
highlight_on_hover = true

[entities.trigger]
mode = "once"
event = "pickup_mana"

[entities.trigger.shape]
type = "sphere"
radius = 1.0

# Gold Pile
[[entities]]
name = "gold_pile_1"
mesh = "cube"
layer = "pickups"
visible = true

[entities.transform]
position = [2.0, 0.2, -10.0]
scale = [0.5, 0.3, 0.5]

[entities.material]
albedo = [0.95, 0.8, 0.2]
metallic = 1.0
roughness = 0.3
emissive = [0.1, 0.08, 0.0]

[entities.animation]
type = "rotate"
axis = [0.0, 1.0, 0.0]
speed = 0.5

[entities.pickable]
enabled = true
highlight_on_hover = true

[entities.trigger]
mode = "once"
event = "pickup_gold"

[entities.trigger.shape]
type = "sphere"
radius = 1.0

# =============================================================================
# Weapons - Chest with Fire Sword
# =============================================================================

[[entities]]
name = "treasure_chest"
mesh = "cube"
layer = "pickups"
visible = true

[entities.transform]
position = [-8.0, 0.4, -15.0]
scale = [0.8, 0.5, 0.5]

[entities.material]
albedo = [0.4, 0.25, 0.1]
metallic = 0.2
roughness = 0.7

[entities.pickable]
enabled = true
highlight_on_hover = true

[entities.physics]
body_type = "static"

[entities.physics.shape]
type = "box"
half_extents = [0.5, 0.5, 0.5]

[entities.trigger]
mode = "once"
event = "open_chest"

[entities.trigger.shape]
type = "sphere"
radius = 1.5

# =============================================================================
# Torch Sconces (decorative)
# =============================================================================

[[entities]]
name = "torch_holder_1"
mesh = "cube"
layer = "world"
visible = true

[entities.transform]
position = [-5.0, 2.0, -8.0]
scale = [0.15, 0.4, 0.15]

[entities.material]
albedo = [0.3, 0.25, 0.2]
metallic = 0.5
roughness = 0.6

[[entities]]
name = "torch_holder_2"
mesh = "cube"
layer = "world"
visible = true

[entities.transform]
position = [5.0, 2.0, -8.0]
scale = [0.15, 0.4, 0.15]

[entities.material]
albedo = [0.3, 0.25, 0.2]
metallic = 0.5
roughness = 0.6

# =============================================================================
# Pillars in boss room
# =============================================================================

[[entities]]
name = "pillar_1"
mesh = "cylinder"
layer = "world"
visible = true

[entities.transform]
position = [-5.0, 2.0, -18.0]
scale = [0.8, 4.0, 0.8]

[entities.material]
albedo = [0.25, 0.22, 0.2]
metallic = 0.0
roughness = 0.85

[entities.physics]
body_type = "static"

[entities.physics.shape]
type = "cylinder"
half_height = 0.5
radius = 0.5

[[entities]]
name = "pillar_2"
mesh = "cylinder"
layer = "world"
visible = true

[entities.transform]
position = [5.0, 2.0, -18.0]
scale = [0.8, 4.0, 0.8]

[entities.material]
albedo = [0.25, 0.22, 0.2]
metallic = 0.0
roughness = 0.85

[entities.physics]
body_type = "static"

[entities.physics.shape]
type = "cylinder"
half_height = 0.5
radius = 0.5

# =============================================================================
# Particle Emitters - Torch flames
# =============================================================================

[[particle_emitters]]
name = "torch_fire_1"
position = [-5.0, 2.8, -8.0]
emit_rate = 50.0
max_particles = 500
lifetime = [0.5, 1.2]
speed = [0.8, 1.5]
size = [0.05, 0.12]
color_start = [1.0, 0.7, 0.2, 1.0]
color_end = [1.0, 0.2, 0.0, 0.0]
gravity = [0.0, 1.0, 0.0]
spread = 0.3
direction = [0.0, 1.0, 0.0]
enabled = true

[[particle_emitters]]
name = "torch_fire_2"
position = [5.0, 2.8, -8.0]
emit_rate = 50.0
max_particles = 500
lifetime = [0.5, 1.2]
speed = [0.8, 1.5]
size = [0.05, 0.12]
color_start = [1.0, 0.7, 0.2, 1.0]
color_end = [1.0, 0.2, 0.0, 0.0]
gravity = [0.0, 1.0, 0.0]
spread = 0.3
direction = [0.0, 1.0, 0.0]
enabled = true

# Boss demonic aura
[[particle_emitters]]
name = "boss_aura"
position = [0.0, 2.5, -20.0]
emit_rate = 30.0
max_particles = 300
lifetime = [1.0, 2.5]
speed = [0.3, 0.8]
size = [0.1, 0.25]
color_start = [1.0, 0.3, 0.1, 0.8]
color_end = [0.5, 0.0, 0.0, 0.0]
gravity = [0.0, 0.5, 0.0]
spread = 1.5
direction = [0.0, 1.0, 0.0]
enabled = true

# =============================================================================
# Debug Configuration
# =============================================================================

[debug]
enabled = false

[debug.stats]
enabled = false
position = "top_left"
font_size = 14
background_alpha = 0.7

[debug.stats.display]
fps = true
frame_time = true
draw_calls = true
entities_total = true

[debug.visualization]
enabled = false
bounds = false
wireframe = false
normals = false
light_volumes = false

[debug.controls]
toggle_key = "F3"
reload_shaders_key = "F5"
